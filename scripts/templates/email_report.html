<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
        .container { max-width: 800px; margin: 0 auto; background: #ffffff; padding: 20px; }
        h1 { color: #333; text-align: center; }
        .summary { background: #e8f4fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 12px; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f8f9fa; }
        .rank-1 { background-color: #d4edda; } /* Greenish for top ranks */
        .rec-strong-buy { color: #155724; font-weight: bold; }
        .rec-buy { color: #28a745; font-weight: bold; }
        .rec-hold { color: #ffc107; font-weight: bold; }
        .rec-avoid { color: #dc3545; font-weight: bold; }
        .footer { font-size: 10px; color: #777; text-align: center; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Institutional Daily Analysis</h1>
        <div class="summary">
            <p><strong>Date:</strong> {{ date }}</p>
            <p><strong>Top Picks:</strong> {{ top_picks }}</p>
        </div>

        <h2>Nifty 50 Rankings</h2>
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Stock</th>
                    <th>Price</th>
                    <th>ROCE</th>
                    <th>EPS Gr.</th>
                    <th>Score</th>
                    <th>Rec</th>
                </tr>
            </thead>
            <tbody>
                {% for stock in nifty_50[:20] %}
                <tr class="rank-{{ loop.index }}">
                    <td>{{ loop.index }}</td>
                    <td>{{ stock.name }}</td>
                    <td>{{ "%.2f"|format(stock.current_price) }}</td>
                    <td>{{ "%.1f"|format(stock.roce * 100) }}%</td>
                    <td>{{ "%.1f"|format(stock.eps_growth * 100) }}%</td>
                    <td>{{ stock.score }}</td>
                    <td class="rec-{{ stock.recommendation|lower|replace(' ', '-') }}">{{ stock.recommendation }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>Crypto Top Movers</h2>
        <table>
            <thead>
                <tr>
                    <th>Coin</th>
                    <th>Price</th>
                    <th>24h %</th>
                </tr>
            </thead>
            <tbody>
                {% for coin in crypto[:5] %}
                <tr>
                    <td>{{ coin.name }}</td>
                    <td>${{ coin.current_price }}</td>
                    <td style="color: {{ 'green' if coin.price_change_24h > 0 else 'red' }}">{{ "%.2f"|format(coin.price_change_24h) }}%</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="footer">
            <p>Generated by Investment Intelligence Bot. Not financial advice.</p>
        </div>
    </div>
</body>
</html>
